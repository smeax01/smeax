---
import { t, type Language } from '../i18n/translations';

interface Props {
  activePage: 'home' | 'gallery' | 'projects' | 'contact';
  lang?: Language;
}

const { activePage, lang = 'fr' } = Astro.props;
const tr = t(lang);

const navLinks = [
  { href: `${import.meta.env.BASE_URL}/?lang=${lang}`, page: 'home', icon: 'home', label: tr('nav_home') },
  { href: `${import.meta.env.BASE_URL}/gallery?lang=${lang}`, page: 'gallery', icon: 'layout-grid', label: tr('nav_gallery') },
  { href: `${import.meta.env.BASE_URL}/projects?lang=${lang}`, page: 'projects', icon: 'flask-conical', label: tr('nav_projects') },
  { href: `${import.meta.env.BASE_URL}/contact?lang=${lang}`, page: 'contact', icon: 'mail', label: tr('nav_contact') },
] as const;
---

<div class="absolute top-4 left-0 right-0 z-50 flex justify-center w-full px-2 md:px-4 pointer-events-none">
  <nav class="pointer-events-auto w-full max-w-[98%] md:max-w-7xl h-14 card-bg rounded-xl px-4 flex items-center justify-between shadow-none transition-all duration-300">
    
    <!-- Left: Logo -->
    <a href={`${import.meta.env.BASE_URL}/?lang=${lang}`} class="flex items-center gap-3 py-2 px-2 -ml-2 rounded-lg hover:bg-white/5 transition-colors group shrink-0">
      <img src={`${import.meta.env.BASE_URL}/icon.png`} alt="Smeax" class="w-8 h-8 object-contain" />
      <span class="font-bold text-adaptive tracking-tight group-hover:text-blue-500 transition-colors block">Smeax</span>
    </a>

    <!-- Center: Nav Links (Desktop) -->
    <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 hidden md:flex items-center gap-1">
      {navLinks.map((link) => (
        <a 
          href={link.href}
          class:list={[
            "nav-link group",
            activePage === link.page 
              ? "nav-link-active" 
              : "nav-link-inactive"
          ]}
        >
          <i data-lucide={link.icon} class="w-4 h-4 group-hover:scale-110 transition-transform"></i>
          <span>{link.label}</span>
        </a>
      ))}
    </div>

    <!-- Right: Actions -->
    <div class="flex items-center gap-3 shrink-0">
      <!-- Mobile Menu Button -->
      <button 
        onclick="toggleMobileMenu()" 
        class="md:hidden flex items-center justify-center w-8 h-8 rounded-lg text-muted-adaptive hover:text-adaptive hover:bg-white/10 transition-colors"
        aria-label="Toggle menu"
      >
        <i data-lucide="menu" class="w-5 h-5"></i>
      </button>

      <!-- Lang Selector -->
      <div class="relative group hidden md:block">
        <button class="flex items-center gap-1 px-2 py-1.5 rounded-lg text-xs font-medium text-muted-adaptive hover:text-adaptive hover:bg-white/10 transition-colors">
          <i data-lucide="languages" class="w-3.5 h-3.5"></i>
          <span id="current-lang-label">{lang.toUpperCase()}</span>
          <i data-lucide="chevron-down" class="w-3 h-3 opacity-50"></i>
        </button>
        
        <!-- Dropdown -->
        <div class="absolute right-0 top-full mt-2 w-24 card-bg border border-white/10 rounded-lg shadow-xl py-1 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform origin-top-right z-50 pointer-events-auto">
          <button 
            onclick="setLanguage('fr')" 
            class="flex items-center gap-2 w-full px-3 py-2 text-xs text-muted-adaptive hover:text-adaptive hover:bg-white/5 text-left"
          >
            <span>ðŸ‡«ðŸ‡·</span> FR
          </button>
          <button 
            onclick="setLanguage('en')" 
            class="flex items-center gap-2 w-full px-3 py-2 text-xs text-muted-adaptive hover:text-adaptive hover:bg-white/5 text-left"
          >
            <span>ðŸ‡¬ðŸ‡§</span> EN
          </button>
        </div>
      </div>

      <div class="w-px h-4 bg-white/10 hidden md:block"></div>

      <!-- Theme Toggle -->
      <button 
        onclick="toggleTheme()" 
        class="hidden md:flex items-center justify-center w-8 h-8 rounded-lg text-muted-adaptive hover:text-adaptive hover:bg-white/10 transition-colors"
        aria-label="Toggle theme"
      >
        <i data-lucide="moon" data-theme-icon class="w-4 h-4"></i>
      </button>
    </div>
  </nav>
</div>
